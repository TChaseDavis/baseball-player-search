<script>
  async function searchPlayer() {
    const nameInput = document.getElementById('playerName');
    const playerName = nameInput.value.trim();

    if (!playerName) return;

    const encodedName = encodeURIComponent(playerName);
    const brUrl = `https://www.baseball-reference.com/search/search.fcgi?search=${encodedName}`;
    const fangraphsSearch = `https://www.google.com/search?q=site:fangraphs.com+${encodedName}`;

    // Query the MLB Stats API
    try {
      const response = await fetch(`https://statsapi.mlb.com/api/v1/people/search?name=${encodedName}`);
      const data = await response.json();

      if (data.people && data.people.length > 0) {
        const player = data.people[0];
        const mlbId = player.id;
        const slugName = player.fullName.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]/g, '');

        const savantUrl = `https://baseballsavant.mlb.com/savant-player/${slugName}-${mlbId}`;

        // Open all 3 tabs
        window.open(brUrl, '_blank');
        window.open(fangraphsSearch, '_blank');
        window.open(savantUrl, '_blank');
      } else {
        alert('Player not found in MLB database.');
      }
    } catch (error) {
      console.error('Error fetching MLB player data:', error);
      alert('Something went wrong while fetching player data.');
    }
  }
</script>
